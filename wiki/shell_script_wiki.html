<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-03-18 一 16:47 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Shell script wiki</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="pengpengxp" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://pengpengxp.github.io/css/wiki.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Shell script wiki</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org2fedb19">1. loop</a></li>
<li><a href="#orgdbff225">2. 老一点的shell中的loop</a></li>
<li><a href="#orgb01901e">3. shell脚本中的判断</a>
<ul>
<li><a href="#orgfe431a9">3.1. 总结</a></li>
</ul>
</li>
<li><a href="#orgfbe2090">4. shell中的判断有时候可以不用写if，直接一行搞定</a></li>
<li><a href="#org793a50c">5. 把标准输出给多个管道做为标准输入</a></li>
<li><a href="#org9271de6">6. shell中去掉前缀和后缀</a></li>
<li><a href="#org00947c9">7. 数组</a></li>
<li><a href="#org8a8a818">8. 得到脚本存放的目录</a></li>
<li><a href="#org1f936e8">9. 脚本中使用cat输入很多内容</a></li>
<li><a href="#org52dbcd7">10. 根据进程是否启动来作不同的处理</a></li>
<li><a href="#orgb99e99d">11. 方便地取得传入的参数</a></li>
</ul>
</div>
</div>

<div id="outline-container-org2fedb19" class="outline-2">
<h2 id="org2fedb19"><span class="section-number-2">1</span> loop</h2>
<div class="outline-text-2" id="text-1">
<p>
下面的例子里，第一个 <code>SERVICE_NAME</code> 是一个数组。每二个我也不知道是啥，
反正可以用。推荐使用第一种方式。
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #8fbc8f;">SERVICE_NAME</span>=(api ess collect registry ras-cluster)
<span style="color: #9acd32;">loop</span>() {
    <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">"Clean RCS service."</span>

    <span style="color: PaleYellow;">for</span> service<span style="color: PaleYellow;"> in</span> <span style="color: #ffa500;">"${SERVICE_NAME[@]}"</span>
    <span style="color: PaleYellow;">do</span>
        <span style="color: #b0c4de;">echo</span> $<span style="color: #8fbc8f;">service</span>
    <span style="color: PaleYellow;">done</span>

}

loop

<span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">"######"</span>
<span style="color: #b0c4de;">echo</span>  ${<span style="color: #8fbc8f;">SERVICE_NAME</span>[1]}

<span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">"${SERVICE_NAME[@]}"</span>
<span style="color: #8fbc8f;">SERVICE</span>=<span style="color: #ffa500;">"api     ess    collect registry ras-cluster"</span>
<span style="color: PaleYellow;">for</span> i<span style="color: PaleYellow;"> in</span> $<span style="color: #8fbc8f;">SERVICE</span>; <span style="color: PaleYellow;">do</span>
    <span style="color: #b0c4de;">echo</span> $<span style="color: #8fbc8f;">i</span>/bin
<span style="color: PaleYellow;">done</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdbff225" class="outline-2">
<h2 id="orgdbff225"><span class="section-number-2">2</span> 老一点的shell中的loop</h2>
<div class="outline-text-2" id="text-2">
<p>
使用busybox时，需要这样做：
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: PaleYellow;">for</span> i<span style="color: PaleYellow;"> in</span> <span style="color: #fa8072;">`seq 1 5`</span>;<span style="color: PaleYellow;">do </span><span style="color: #b0c4de;">echo</span> $<span style="color: #8fbc8f;">i</span>;<span style="color: PaleYellow;">done</span>  
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb01901e" class="outline-2">
<h2 id="orgb01901e"><span class="section-number-2">3</span> shell脚本中的判断</h2>
<div class="outline-text-2" id="text-3">
<p>
下面的版本应该选择哪一个：
</p>
<div class="org-src-container">
<pre class="src src-sh">    <span style="color: #8fbc8f;">has_gunzip</span>=1
    <span style="color: PaleYellow;">if</span> [ $<span style="color: #8fbc8f;">has_gunzip</span> = 1 ]; <span style="color: PaleYellow;">then</span>
        <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'yes'</span>
    <span style="color: PaleYellow;">else</span>
        <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'no'</span>
    <span style="color: PaleYellow;">fi</span>

    <span style="color: PaleYellow;">if</span> [[ $<span style="color: #8fbc8f;">has_gunzip</span> = 1 ]]; <span style="color: PaleYellow;">then</span>
        <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'yes'</span>
    <span style="color: PaleYellow;">else</span>
        <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'no'</span>
    <span style="color: PaleYellow;">fi</span>

    <span style="color: PaleYellow;">if</span> [[ $<span style="color: #8fbc8f;">has_gunzip</span> == 1 ]]; <span style="color: PaleYellow;">then</span>
        <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'yes'</span>
    <span style="color: PaleYellow;">else</span>
        <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'no'</span>
    <span style="color: PaleYellow;">fi</span>

    <span style="color: PaleYellow;">if</span> [ $<span style="color: #8fbc8f;">has_gunzip</span> == 1 ]; <span style="color: PaleYellow;">then</span>
        <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'yes'</span>
    <span style="color: PaleYellow;">else</span>
        <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'no'</span>
    <span style="color: PaleYellow;">fi</span>

    <span style="color: PaleYellow;">if</span> [ <span style="color: #ffa500;">"$has_gunzip"</span> == 1 ]; <span style="color: PaleYellow;">then</span>
        <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'yes'</span>
    <span style="color: PaleYellow;">else</span>
        <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'no'</span>
    <span style="color: PaleYellow;">fi</span>
</pre>
</div>

<p>
看下下面的例子：
</p>
<pre class="example">
    bash-4.4$ x=1
    bash-4.4$ [ $x = 1 ] &amp;&amp; echo y
    y
    bash-4.4$ unset x
    bash-4.4$ [ $x = 1 ] &amp;&amp; echo y
    bash: [: =: unary operator expected
    bash-4.4$ [[ $x = 1 ]] &amp;&amp; echo y
    bash-4.4$ [ $x = 1 ] &amp;&amp; echo y
    bash: [: =: unary operator expected
    bash-4.4$ [ "$x" = 1 ] &amp;&amp; echo y
    bash-4.4$ x=1
    bash-4.4$ [ "$x" = 1 ] &amp;&amp; echo y
    y
    bash-4.4$ [ $x = 1 ] &amp;&amp; echo y
    y
    bash-4.4$ [[ $x = 1 ]] &amp;&amp; echo y
    y
    bash-4.4$ [[ "$x" = 1 ]] &amp;&amp; echo y
    y
    bash-4.4$

</pre>

<p>
原因：在很老的bash上只有
</p>
<div class="org-src-container">
<pre class="src src-sh">    [ $<span style="color: #8fbc8f;">x</span> = 1 ]
</pre>
</div>
<p>
这种单个中括号的。如果里面判断的变量未定义，直接使用这种方式会报错。
需要这样
</p>
<div class="org-src-container">
<pre class="src src-sh">    [ <span style="color: #ffa500;">"$x"</span> = 1 ]
</pre>
</div>

<p>
新的bash支持
</p>
<div class="org-src-container">
<pre class="src src-sh">    [[ $<span style="color: #8fbc8f;">x</span>=1 ]]
</pre>
</div>
<p>
这种，它在x没有定义时也不会报错。
</p>

<p>
至于一个等号还是两个。好像是都可以的。
</p>

<p>
<b>所以推荐使用：</b>
</p>
<div class="org-src-container">
<pre class="src src-sh">    <span style="color: PaleYellow;">if</span> [ <span style="color: #ffa500;">"$has_gunzip"</span> = 1 ]; <span style="color: PaleYellow;">then</span>
        <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'yes'</span>
    <span style="color: PaleYellow;">else</span>
        <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'no'</span>
    <span style="color: PaleYellow;">fi</span>
</pre>
</div>
<p>
这种方式。兼容性最好。
</p>

<p>
下面是bash的man page：
</p>
<pre class="example">
    string1 == string2
    string1 = string2
    True if the strings are equal.  = should be used with the test command for POSIX conformance.  When used with the [[ command, this performs pattern matching as described above (Compound Com- mands).




    test expr
    [ expr ]
           Return a status of 0 (true) or 1 (false) depending on the evaluation of the conditional expression expr.  Each operator and operand must be a separate argument.  Expressions are composed of the
           primaries described above under CONDITIONAL EXPRESSIONS.  test does not accept any options, nor does it accept and ignore an argument of -- as signifying the end of options.

           Expressions  may be combined using the following operators, listed in decreasing order of precedence.  The evaluation depends on the number of arguments; see below.  Operator precedence is used
           when there are five or more arguments.
           ! expr True if expr is false.
           ( expr )
                  Returns the value of expr.  This may be used to override the normal precedence of operators.
           expr1 -a expr2
                  True if both expr1 and expr2 are true.
           expr1 -o expr2
                  True if either expr1 or expr2 is true.

           test and [ evaluate conditional expressions using a set of rules based on the number of arguments.

           0 arguments
                  The expression is false.
           1 argument
                  The expression is true if and only if the argument is not null.
           2 arguments
                  If the first argument is !, the expression is true if and only if the second argument is null.  If the first argument is one of the unary conditional operators listed above under  CONDI-
                  TIONAL EXPRESSIONS, the expression is true if the unary test is true.  If the first argument is not a valid unary conditional operator, the expression is false.
           3 arguments
                  The following conditions are applied in the order listed.  If the second argument is one of the binary conditional operators listed above under CONDITIONAL EXPRESSIONS, the result of the
                  expression is the result of the binary test using the first and third arguments as operands.  The -a and -o operators are considered binary operators when there are three arguments.   If
                  the first argument is !, the value is the negation of the two-argument test using the second and third arguments.  If the first argument is exactly ( and the third argument is exactly ),
                  the result is the one-argument test of the second argument.  Otherwise, the expression is false.
           4 arguments
                  If the first argument is !, the result is the negation of the three-argument expression composed of the remaining arguments.  Otherwise, the expression is parsed and evaluated  according
                  to precedence using the rules listed above.
           5 or more arguments
                  The expression is parsed and evaluated according to precedence using the rules listed above.

           When used with test or [, the &lt; and &gt; operators sort lexicographically using ASCII ordering.





           [[ expression ]]
                  Return  a  status of 0 or 1 depending on the evaluation of the conditional expression expression.  Expressions are composed of the primaries described below under CONDITIONAL EXPRESSIONS.  Word
                  splitting and pathname expansion are not performed on the words between the [[ and ]]; tilde expansion, parameter and variable expansion, arithmetic  expansion,  command  substitution,  process
                  substitution, and quote removal are performed.  Conditional operators such as -f must be unquoted to be recognized as primaries.

                  When used with [[, the &lt; and &gt; operators sort lexicographically using the current locale.

                  When  the == and != operators are used, the string to the right of the operator is considered a pattern and matched according to the rules described below under Pattern Matching, as if the ext-
                  glob shell option were enabled.  The = operator is equivalent to ==.  If the nocasematch shell option is enabled, the match is performed without regard to the  case  of  alphabetic  characters.
                  The  return  value  is  0  if  the string matches (==) or does not match (!=) the pattern, and 1 otherwise.  Any part of the pattern may be quoted to force the quoted portion to be matched as a
                  string.

                  An additional binary operator, =~, is available, with the same precedence as == and !=.  When it is used, the string to the right of the operator is considered an  extended  regular  expression
                  and  matched  accordingly  (as  in  regex(3)).   The return value is 0 if the string matches the pattern, and 1 otherwise.  If the regular expression is syntactically incorrect, the conditional
                  expression's return value is 2.  If the nocasematch shell option is enabled, the match is performed without regard to the case of alphabetic characters.  Any part of the pattern may  be  quoted
                  to  force the quoted portion to be matched as a string.  Bracket expressions in regular expressions must be treated carefully, since normal quoting characters lose their meanings between brack-
                  ets.  If the pattern is stored in a shell variable, quoting the variable expansion forces the entire pattern to be matched as a  string.   Substrings  matched  by  parenthesized  subexpressions
                  within  the  regular expression are saved in the array variable BASH_REMATCH.  The element of BASH_REMATCH with index 0 is the portion of the string matching the entire regular expression.  The
                  element of BASH_REMATCH with index n is the portion of the string matching the nth parenthesized subexpression.

                  Expressions may be combined using the following operators, listed in decreasing order of precedence:

                  ( expression )
                         Returns the value of expression.  This may be used to override the normal precedence of operators.
                  ! expression
                         True if expression is false.
                  expression1 &amp;&amp; expression2
                         True if both expression1 and expression2 are true.
                  expression1 || expression2
                         True if either expression1 or expression2 is true.

                  The &amp;&amp; and || operators do not evaluate expression2 if the value of expression1 is sufficient to determine the return value of the entire conditional expression.
</pre>

<p>
<a href="https://unix.stackexchange.com/questions/16109/bash-double-equals-vs-eq/16115#16115">这里</a> 有更细的说明：
</p>
<pre class="example">
    To elaborate on bollovan's answer...

    There is no &gt;= or &lt;= comparison operator for strings. But you could
    use them with the ((...)) arithmetic command to compare integers.

    You can also use the other string comparison operators (==, !=, &lt;, &gt;,
    but not =) to compare integers if you use them inside ((...)).

    Examples

    Both [[ 01 -eq 1 ]] and (( 01 == 1 )) do integer comparisons. Both are true.
    Both [[ 01 == 1 ]] and [ 01 = 1 ] do string comparisons. Both are false.
    Both (( 01 -eq 1 )) and (( 01 = 1 )) will return an error.
    Note: The double bracket syntax [[...]] and the double parentheses syntax ((...)) are not supported by all shells.
</pre>
</div>
<div id="outline-container-orgfe431a9" class="outline-3">
<h3 id="orgfe431a9"><span class="section-number-3">3.1</span> 总结</h3>
<div class="outline-text-3" id="text-3-1">
<p>
以string的方式来对比的话，下面几种方式是相同的，一个中括号和两个中
括号没有区别。一个和两个等号也没有区别：
</p>
<div class="org-src-container">
<pre class="src src-sh">     <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'**************** [[ 01 == 1 ]] ****************'</span>
     <span style="color: PaleYellow;">if</span> [[ 01 == 1 ]]; <span style="color: PaleYellow;">then</span>
         <span style="color: #b0c4de;">echo</span><span style="color: #ffa500;">'True'</span>
     <span style="color: PaleYellow;">else</span>
         <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'False'</span>       
     <span style="color: PaleYellow;">fi</span>

     <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'**************** [[ 01 = 1 ]] ****************'</span>
     <span style="color: PaleYellow;">if</span> [[ 01 = 1 ]]; <span style="color: PaleYellow;">then</span>
         <span style="color: #b0c4de;">echo</span><span style="color: #ffa500;">'True'</span>
     <span style="color: PaleYellow;">else</span>
         <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'False'</span>       
     <span style="color: PaleYellow;">fi</span>

     <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'**************** [ 01 == 1 ] ****************'</span>
     <span style="color: PaleYellow;">if</span> [ 01 == 1 ]; <span style="color: PaleYellow;">then</span>
         <span style="color: #b0c4de;">echo</span><span style="color: #ffa500;">'True'</span>
     <span style="color: PaleYellow;">else</span>
         <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'False'</span>       
     <span style="color: PaleYellow;">fi</span>

     <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'**************** [ 01 = 1 ] ****************'</span>
     <span style="color: PaleYellow;">if</span> [ 01 = 1 ]; <span style="color: PaleYellow;">then</span>
         <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'True'</span>
     <span style="color: PaleYellow;">else</span>
         <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'False'</span>       
     <span style="color: PaleYellow;">fi</span>

     <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'**************** [ 1 == 1 ] ****************'</span>
     <span style="color: PaleYellow;">if</span> [ 1 == 1 ]; <span style="color: PaleYellow;">then</span>
         <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'True'</span>
     <span style="color: PaleYellow;">else</span>
         <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'False'</span>       
     <span style="color: PaleYellow;">fi</span>
</pre>
</div>

<p>
不是所有的shell都支持两个中括号的形式：
</p>
<div class="org-src-container">
<pre class="src src-sh">     [[ <span style="color: #8fbc8f;">x</span>=1 ]]
</pre>
</div>

<p>
以数值来比，就没有一个等号说法：
</p>
<div class="org-src-container">
<pre class="src src-sh">     <span style="color: PaleYellow;">if</span> (( 1 == 1 )); <span style="color: PaleYellow;">then</span>
         <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'True'</span>
     <span style="color: PaleYellow;">else</span>
         <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'False'</span>
     <span style="color: PaleYellow;">fi</span>

     <span style="color: PaleYellow;">if</span> [[ 1 -eq 1 ]]; <span style="color: PaleYellow;">then</span>
         <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'True'</span>
     <span style="color: PaleYellow;">else</span>
         <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">'False'</span>
     <span style="color: PaleYellow;">fi</span>
</pre>
</div>

<p>
最后，多看下这个：
</p>
<pre class="example">
     Both [[ 01 -eq 1 ]] and (( 01 == 1 )) do integer comparisons. Both are true.
     Both [[ 01 == 1 ]] and [ 01 = 1 ] do string comparisons. Both are false.
     Both (( 01 -eq 1 )) and (( 01 = 1 )) will return an error.
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfbe2090" class="outline-2">
<h2 id="orgfbe2090"><span class="section-number-2">4</span> shell中的判断有时候可以不用写if，直接一行搞定</h2>
<div class="outline-text-2" id="text-4">
<p>
判断是否是file还是dir
</p>
<div class="org-src-container">
<pre class="src src-sh">    [ -f /tmp ] &amp;&amp; <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">"yes it is a file"</span> || <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">"no it is not a file"</span>
    [ -d /tmp ] &amp;&amp; <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">"yes it's a directory"</span> || <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">"no is's not a directory"</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org793a50c" class="outline-2">
<h2 id="org793a50c"><span class="section-number-2">5</span> 把标准输出给多个管道做为标准输入</h2>
<div class="outline-text-2" id="text-5">
<p>
zsh下可以这样：
</p>
<div class="org-src-container">
<pre class="src src-sh">    touch /tmp/1 /tmp/2
    ls /tmp/ &gt; &gt;(grep 1) &gt; &gt;(grep 2)
</pre>
</div>
</div>
</div>

<div id="outline-container-org9271de6" class="outline-2">
<h2 id="org9271de6"><span class="section-number-2">6</span> shell中去掉前缀和后缀</h2>
<div class="outline-text-2" id="text-6">
<div class="org-src-container">
<pre class="src src-sh">    <span style="color: #8fbc8f;">foo</span>=/Users/pengpengxp/Library/Application<span style="color: #ffa500;">\ </span>Support/Karabiner/private.xml
    <span style="color: #8fbc8f;">HOME</span>=<span style="color: #fa8072;">`echo ~`</span>
    <span style="color: #8fbc8f;">suffix</span>=<span style="color: #ffa500;">"private.xml"</span>

    <span style="color: #8fbc8f;">foo</span>=${<span style="color: #8fbc8f;">foo</span>#$<span style="color: #8fbc8f;">HOME</span>/}
    <span style="color: #8fbc8f;">foo</span>=${<span style="color: #8fbc8f;">foo</span>%$<span style="color: #8fbc8f;">suffix</span>}

    <span style="color: #b0c4de;">echo</span> $<span style="color: #8fbc8f;">foo</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org00947c9" class="outline-2">
<h2 id="org00947c9"><span class="section-number-2">7</span> 数组</h2>
<div class="outline-text-2" id="text-7">
<div class="org-src-container">
<pre class="src src-sh">    <span style="color: #8fbc8f;">FILES</span>=(
        ~/.bashrc
        ~/.peng_bashrc
        ~/.zshrc
        ~/.mutt
        ~/.muttrc
        ~/.slate
        ~/.ssh
        ~/.stardict
        ~/.tigrc
        ~/.tmux.conf
        ~/.vimrc
        ~/.zsh
    )

    <span style="color: PaleYellow;">for</span> f<span style="color: PaleYellow;"> in</span> <span style="color: #ffa500;">"${FILES[@]}"</span>
    <span style="color: PaleYellow;">do</span>
        <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">"================backup $f================"</span>
    <span style="color: PaleYellow;">done</span>
</pre>
</div>

<p>
读取数组的一般格式是这样的：
</p>
<pre class="example">
    ${array_name[index]}
</pre>
<div class="org-src-container">
<pre class="src src-sh">    <span style="color: #8fbc8f;">a</span>=(A B C D)

    <span style="color: #b0c4de;">echo</span> ${<span style="color: #8fbc8f;">a</span>[0]}
    <span style="color: #b0c4de;">echo</span> ${<span style="color: #8fbc8f;">a</span>[1]}
    <span style="color: #b0c4de;">echo</span> ${<span style="color: #8fbc8f;">a</span>[2]}
    <span style="color: #b0c4de;">echo</span> ${<span style="color: #8fbc8f;">a</span>[3]}
</pre>
</div>

<p>
使用 <code>@</code> 或 <code>*</code> 可以获取数组中的所有元素：
</p>
<div class="org-src-container">
<pre class="src src-sh">    <span style="color: #8fbc8f;">a</span>=(A B C D)

    <span style="color: #b0c4de;">echo</span> ${<span style="color: #8fbc8f;">a</span>[@]}
    <span style="color: #b0c4de;">echo</span> ${<span style="color: #8fbc8f;">a</span>[*]}
</pre>
</div>

<p>
获取数组长度的方法与获取字符串长度的方法相同:
</p>
<div class="org-src-container">
<pre class="src src-sh">
    <span style="color: #8fbc8f;">a</span>=(A B C D)

    <span style="color: #b0c4de;">echo</span> ${#<span style="color: #8fbc8f;">a</span>[@]}
    <span style="color: #b0c4de;">echo</span> ${#<span style="color: #8fbc8f;">a</span>[*]}
</pre>
</div>
</div>
</div>

<div id="outline-container-org8a8a818" class="outline-2">
<h2 id="org8a8a818"><span class="section-number-2">8</span> 得到脚本存放的目录</h2>
<div class="outline-text-2" id="text-8">
<p>
脚本目录加入 <code>PATH</code> 变量后，可以在任何地方运行脚本。那么怎么得到脚本
存放的地址呢？ <code>$0</code> 里面其实就存放是脚本的绝对地址啦。把下面脚本加入
<code>PATH</code> 路径中的一处，然后在任何地方试试？都会输出脚本的绝对路径的。
</p>
<div class="org-src-container">
<pre class="src src-sh">    <span style="color: #cd5c5c;">#</span><span style="color: #cd5c5c;">!/bin/bash</span>

    <span style="color: #b0c4de;">echo</span> $<span style="color: #8fbc8f;">0</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1f936e8" class="outline-2">
<h2 id="org1f936e8"><span class="section-number-2">9</span> 脚本中使用cat输入很多内容</h2>
<div class="outline-text-2" id="text-9">
<p>
下面这样的 <code>EOF</code> 可以换为其它，只要两个对应得上就可以。
</p>
<div class="org-src-container">
<pre class="src src-sh">cat &lt;&lt; EOF  &gt; /tmp/kk
<span style="color: #ffff00; font-weight: bold;">    xiwapnefwfwajf</span>
<span style="color: #ffff00; font-weight: bold;">EOF</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org52dbcd7" class="outline-2">
<h2 id="org52dbcd7"><span class="section-number-2">10</span> 根据进程是否启动来作不同的处理</h2>
<div class="outline-text-2" id="text-10">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #cd5c5c;">#</span><span style="color: #cd5c5c;">!/bin/</span><span style="color: PaleYellow;">bash</span>


mkdir -p ~/.rtags/rtags_db


<span style="color: PaleYellow;">function</span> <span style="color: #9acd32;">run</span>()
{
    <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">"start rdm server."</span>

    rdm --socket-file=~/.rtags/rdm_socket <span style="color: #ffa500;">\</span>
        --no-rc                           <span style="color: #ffa500;">\</span>
        --data-dir=~/.rtags/rtags_db      <span style="color: #ffa500;">\</span>
        --log-file=~/.rtags/rtags.log     <span style="color: #ffa500;">\</span>
        --crash-dump-file=crash_dump.txt  <span style="color: #ffa500;">\</span>
        --job-count=12                    <span style="color: #ffa500;">\</span>
        --watch-sources-only              <span style="color: #ffa500;">\</span>
        --sandbox-root=~/ &amp;
}

pgrep <span style="color: #ffa500;">"^rdm$"</span> &amp;&amp; <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">"rdm is already running."</span> &amp;&amp; <span style="color: PaleYellow;">exit</span> 1

pgrep <span style="color: #ffa500;">"^rdm$"</span> || <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">"start rdm server."</span> &amp;&amp; run
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb99e99d" class="outline-2">
<h2 id="orgb99e99d"><span class="section-number-2">11</span> 方便地取得传入的参数</h2>
<div class="outline-text-2" id="text-11">
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #8fbc8f;">option</span>=${<span style="color: #8fbc8f;">1</span>:-<span style="color: #ffa500;">"start"</span>}
<span style="color: PaleYellow;">if</span> [ $<span style="color: #8fbc8f;">option</span> = <span style="color: #ffa500;">"start"</span> ]; <span style="color: PaleYellow;">then</span>
    <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">"start"</span>
<span style="color: PaleYellow;">elif</span> [ $<span style="color: #8fbc8f;">option</span> = <span style="color: #ffa500;">"install"</span> ]; <span style="color: PaleYellow;">then</span>
  <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">"install"</span>
<span style="color: PaleYellow;">elif</span> [ $<span style="color: #8fbc8f;">option</span> = <span style="color: #ffa500;">"debug"</span> ]; <span style="color: PaleYellow;">then</span>
    <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">"debug"</span>
<span style="color: PaleYellow;">elif</span> [ $<span style="color: #8fbc8f;">option</span> = <span style="color: #ffa500;">"uninstall"</span> ]; <span style="color: PaleYellow;">then</span>
    <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">"uninstall"</span>
<span style="color: PaleYellow;">else</span>
  <span style="color: #b0c4de;">echo</span> <span style="color: #ffa500;">"unknown"</span>
  <span style="color: PaleYellow;">exit</span> 127
<span style="color: PaleYellow;">fi</span>
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: pengpengxp</p>
<p class="date">Created: 2019-03-18 一 16:47</p>
<p class="validation"></p>
</div>
</body>
</html>
